FROM node:23-alpine AS builder
WORKDIR /app

ADD . .

ENV BASE_URL "/api"
ENV AUTH_SERVER_CLIENT_ID ""

RUN npm i -g pnpm && \
    cd packages/frontend && \
    pnpm i --frozen-lockfile && \
    pnpm build

FROM nginx AS runner

COPY --from=builder /app/dist /usr/share/nginx/html

EXPOSE 80
